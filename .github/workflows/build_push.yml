   name: Build and Push Docker Image

   on:
      workflow_run:
         workflows:
            - "maven"
         types:
            - completed
      push:
         branches: [ "main" ]
      pull_request:
         branches: [ "main" ]

   jobs:
     build:
       runs-on: ubuntu-latest

       steps:
       - name: Checkout code
         uses: actions/checkout@v3

       - name: Set up Docker Buildx
         uses: docker/setup-buildx-action@v1

       - name: Login to Docker Registry
         uses: docker/login-action@v1
         with:
           registry: https://cvizard.com:5001
           username: ${{ secrets.DOCKER_USERNAME }}
           password: ${{ secrets.DOCKER_PASSWORD }}

       - name: Build and push
         uses: docker/build-push-action@v2
         with:
           context: .
           push: true
           tags: https://cvizard.com:5001/pdfconverter:${{ github.sha }}
